<div class="menu-edit-container">
  <!-- Header with Breadcrumb and Actions -->
  <div class="page-header">
    <div class="breadcrumb">
      <button mat-icon-button (click)="onCancel()" class="back-button">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <div class="breadcrumb-text">
        <a routerLink="/menu" class="breadcrumb-link">Menu</a>
        <mat-icon class="breadcrumb-separator">chevron_right</mat-icon>
        <span class="breadcrumb-current">{{ isEditMode ? 'Edit Item' : 'New Item' }}</span>
      </div>
    </div>
    
    <!-- Desktop Action Buttons -->
    <div class="header-actions desktop-actions">
      <button mat-button (click)="onCancel()" [disabled]="isSaving">
        Cancel
      </button>
      <button mat-raised-button 
              color="primary" 
              (click)="onSave()"
              [disabled]="form.invalid || isSaving">
        <mat-icon *ngIf="isSaving">
          <mat-spinner diameter="20"></mat-spinner>
        </mat-icon>
        <mat-icon *ngIf="!isSaving">save</mat-icon>
        {{ isEditMode ? 'Save Changes' : 'Create Item' }}
      </button>
    </div>
  </div>

  <!-- Main Content -->
  <div class="content-wrapper">
    <mat-card class="form-card">
      <form [formGroup]="form" class="menu-form">
        
        <!-- Two Column Layout for Desktop -->
        <div class="form-layout">
          
          <!-- Left Column: Image Preview -->
          <div class="image-section">
            <div class="image-preview-container">
              <div class="image-label">Image Preview</div>
              <div class="image-preview">
                <img *ngIf="imagePreviewUrl" 
                     [src]="imagePreviewUrl" 
                     alt="Preview"
                     (error)="$any($event.target).src='https://www.foodservicerewards.com/cdn/shop/t/262/assets/fsr-placeholder.png?v=45093109498714503231652397781'">
                <div *ngIf="!imagePreviewUrl" class="placeholder-image">
                  <mat-icon>image</mat-icon>
                  <p>No image</p>
                </div>
              </div>
            </div>

            <!-- Image URL Field (Desktop - in left column) -->
            <mat-form-field appearance="outline" class="full-width desktop-only">
              <mat-label>Image URL</mat-label>
              <input matInput 
                     formControlName="imageUrl" 
                     placeholder="https://example.com/image.jpg">
              <mat-icon matPrefix>link</mat-icon>
              <mat-error *ngIf="form.get('imageUrl')?.invalid">
                {{ getErrorMessage('imageUrl') }}
              </mat-error>
              <mat-hint>Enter a valid image URL</mat-hint>
            </mat-form-field>
          </div>

          <!-- Right Column: Form Fields -->
          <div class="form-fields">
            
            <!-- Basic Information Section -->
            <div class="form-section">
              <h3 class="section-title">Basic Information</h3>
              
              <!-- Name Field -->
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Item Name</mat-label>
                <input matInput 
                       formControlName="name" 
                       placeholder="Enter item name"
                       maxlength="100">
                <mat-icon matPrefix>restaurant</mat-icon>
                <mat-hint align="end">{{ form.get('name')?.value?.length || 0 }}/100</mat-hint>
                <mat-error *ngIf="form.get('name')?.invalid">
                  {{ getErrorMessage('name') }}
                </mat-error>
              </mat-form-field>

              <!-- Description Field -->
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Description</mat-label>
                <textarea matInput 
                          formControlName="description" 
                          placeholder="Enter item description"
                          rows="4"
                          maxlength="500"></textarea>
                <mat-icon matPrefix>description</mat-icon>
                <mat-hint align="end">{{ form.get('description')?.value?.length || 0 }}/500</mat-hint>
                <mat-error *ngIf="form.get('description')?.invalid">
                  {{ getErrorMessage('description') }}
                </mat-error>
              </mat-form-field>
            </div>

            <!-- Pricing & Category Section -->
            <div class="form-section">
              <h3 class="section-title">Pricing & Category</h3>
              
              <div class="form-row">
                <!-- Price Field -->
                <mat-form-field appearance="outline" class="half-width">
                  <mat-label>Price</mat-label>
                  <input matInput 
                         type="number" 
                         formControlName="price" 
                         placeholder="0.00"
                         min="0"
                         step="0.01">
                  <span matPrefix>â‚¹&nbsp;</span>
                  <mat-error *ngIf="form.get('price')?.invalid">
                    {{ getErrorMessage('price') }}
                  </mat-error>
                </mat-form-field>

                <!-- Category/Classification Field -->
                <mat-form-field appearance="outline" class="half-width">
                  <mat-label>Category</mat-label>
                  <mat-select formControlName="classification" placeholder="Select category">
                    <mat-option value="veg">
                      <span class="category-option">
                        <span class="veg-indicator"></span>
                        Veg
                      </span>
                    </mat-option>
                    <mat-option value="non-veg">
                      <span class="category-option">
                        <span class="non-veg-indicator"></span>
                        Non Veg
                      </span>
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="form.get('classification')?.invalid">
                    {{ getErrorMessage('classification') }}
                  </mat-error>
                </mat-form-field>
              </div>
            </div>

            <!-- Image URL Field (Mobile - in form column) -->
            <div class="form-section mobile-only">
              <h3 class="section-title">Image</h3>
              <mat-form-field appearance="outline" class="full-width">
                <mat-label>Image URL</mat-label>
                <input matInput 
                       formControlName="imageUrl" 
                       placeholder="https://example.com/image.jpg">
                <mat-icon matPrefix>link</mat-icon>
                <mat-error *ngIf="form.get('imageUrl')?.invalid">
                  {{ getErrorMessage('imageUrl') }}
                </mat-error>
                <mat-hint>Enter a valid image URL</mat-hint>
              </mat-form-field>
            </div>

            <!-- Availability Section -->
            <div class="form-section">
              <h3 class="section-title">Availability</h3>
              <div class="availability-toggle">
                <mat-slide-toggle formControlName="itemAvailable" color="primary">
                  <span class="toggle-label">
                    <mat-icon>{{ form.get('itemAvailable')?.value ? 'check_circle' : 'cancel' }}</mat-icon>
                    {{ form.get('itemAvailable')?.value ? 'Available' : 'Unavailable' }}
                  </span>
                </mat-slide-toggle>
                <p class="availability-hint">Toggle to change item availability status</p>
              </div>
            </div>

          </div>
        </div>

      </form>
    </mat-card>
  </div>

  <!-- Mobile Sticky Action Bar -->
  <div class="mobile-actions">
    <button mat-button (click)="onCancel()" [disabled]="isSaving" class="mobile-cancel-btn">
      Cancel
    </button>
    <button mat-raised-button 
            color="primary" 
            (click)="onSave()"
            [disabled]="form.invalid || isSaving"
            class="mobile-save-btn">
      <mat-spinner *ngIf="isSaving" diameter="20"></mat-spinner>
      <span *ngIf="!isSaving">{{ isEditMode ? 'Save Changes' : 'Create Item' }}</span>
    </button>
  </div>

</div>
